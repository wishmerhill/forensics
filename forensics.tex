\documentclass[11pt,a4paper]{article}
\usepackage[italian]{babel}
\usepackage[latin1]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{blindtext}
\usepackage{scrextend}
\usepackage{url}
\usepackage[big,binding=0cm]{layaureo}
\usepackage{tikz}
\usepackage[hidelinks]{hyperref}
\usepackage[nottoc]{tocbibind}
\usetikzlibrary{shapes.geometric, arrows}
\tikzstyle{startstop} = [rectangle, 
						 rounded corners, 
						 minimum width=3cm, 
						 minimum height=1cm,
						 text centered, 
						 draw=black, 
						 fill=red!30]
						 
\tikzstyle{io} = [trapezium, 
				  trapezium left angle=70, 
				  trapezium right angle=110, 
				  minimum width=3cm, 
				  minimum height=1cm, 
				  text centered, 
				  draw=black, 
				  fill=blue!30
				  ]
\tikzstyle{process} = [rectangle, 
					   minimum width=3cm, 
					   minimum height=1cm, 
					   text centered, 
					   draw=black, 
					   fill=orange!30, 
					   text width=0.95\linewidth]
					   
\tikzstyle{process_red} = [rectangle, 
					   minimum width=3cm, 
					   minimum height=1cm, 
					   text centered, 
					   draw=black, 
					   fill=red!70, 
					   text width=0.95\linewidth]
					   
\tikzstyle{decision} = [diamond, 
						minimum width=4cm, 
						minimum height=4cm, 
						text centered, 
						draw=black, 
						fill=green!30, 
						text width= 3.5cm ]
						
\tikzstyle{arrow} = [thick,
					 ->,
					 >=stealth]

\begin{document}
	\title{Digital Forensics \\ Repertamento e analisi delle evidenze digitali}
	\date{Marzo 2016}
	\author{A cura del Capitano Alberto Azzalini \\ Comandante della Compagnia Carabinieri di Vipiteno}
	\maketitle
	\tableofcontents

	\section{Premessa}
		Nell'ambito dell'attività quotidiana delle forze di polizia è sempre più frequente, ormai, imbattersi nella necessità di conservare, analizzare e valutare materiale cosiddetto informatico o ad alta tecnologia. 
		Già la ``semplice'' analisi di un tabulato di traffico telefonico (fonia o eventualmente anche dati) è di fatto una analisi forense, sebbene certamente non sofisticata quanto quella di un computer.
		
		Di fatto, oggi non esiste fenomeno giuridicamente rilevante che non abbia una componente digitale dalla quale estrarre informazioni utili alla ricostruzione dei fatti.
		
		Nel tempo, le procedure operative hanno subito notevoli cambiamenti, dovuti principalmente alle innovazioni intervenute sui mezzi di comunicazione informatica e sulle piattaforme sociali diffusesi negli ultimi tempi.
		
		Se ad esempio fino a qualche anno fa la regola nel repertare un \textit{personal computer} acceso era quella di spegnerlo senza particolari cautele (staccando molto semplicemente la spina) per poi procedere alla sigillatura delle porte e alla chiusura del plico.
		
		Oggi non si opera più in questo modo, almeno non sempre, in quanto si è visto che il contenuto della memoria volatile del computer può essere determinante o comunque di notevole importanza per le indagini. Come operare allora?
		
		Non esiste una regola unica e valida per tutte le occasioni, se non quella di applicare in ogni caso il buon senso, nel rispetto del Codice di Procedura Penale, e la sensibilità investigativa maturata nel corso di anni di indagini, anche tradizionali.
		
		In quest'ottica, nessun tecnico puro, nemmeno il più bravo, può sostituirsi all'investigatore nell'analisi dei dati ricavati da un sistema informatico di qualsiasi natura: la mole delle informazioni da visionare è tale e tanta che ci vorrebbero anni di lavoro-uomo per considerarle tutte. La bravura dell'investigatore, in qualsiasi tipo di indagine, è proprio quella di andare a scovare gli elementi utili tra le pieghe delle informazioni che è riuscito a raccogliere: nel caso delle indagini forensi, si tratta di analizzare gigabyte e gigabyte di dati, visto che ormai il prezzo degli hard disk è sceso a tal punto che un disco da un terabyte (1000 gigabyte) è ormai il taglio minimo per un computer desktop.
	\section{Fonti normative}
		Con la legge n.~48 del 18 marzo 2008 è stata ratificata la Convenzione del Consiglio d'Europa sulla criminalità informatica, risalente al novembre 2001. La legge si occupa in generale di criminalità informatica, e introduce significative modifiche al codice penale in tale ambito. Oltre a queste, tuttavia, sono state inserite anche novità al Codice di Procedura Penale che risultano di particolare interesse per l'informatica forense.
		\begin{description}
			\item[Art. 244 c.p.p.] Casi e forme delle ispezioni
			\begin{enumerate}
				\item L'ispezione delle persone, dei luoghi e delle cose è disposta con decreto motivato quando occorre accertare le tracce e gli altri effetti materiali del reato.
				\item Se il reato non ha lasciato tracce o effetti materiali, o se questi sono scomparsi o sono stati cancellati o dispersi, alterati o rimossi, l'autorità giudiziaria descrive lo stato attuale e, in quanto possibile, verifica quello preesistente, curando anche di individuare modo, tempo e cause delle eventuali modificazioni. L'autorità giudiziaria può disporre rilievi segnaletici, descrittivi e fotografici e ogni altra operazione tecnica [359], \textbf{anche in relazione a sistemi informatici o telematici, adottando misure tecniche dirette ad assicurare la conservazione dei dati originali e ad impedirne l'alterazione.}
			\end{enumerate}
			\item[Art. 247 c.p.p.] Casi e forme delle perquisizioni
			\begin{labeling}{1-bis.}
				\item[\textellipsis]
				\item[1-bis.] Quando vi è fondato motivo di ritenere che dati, informazioni, programmi informatici o tracce comunque pertinenti al reato si trovino in un sistema informatico o telematico, ancorché protetto da misure di sicurezza, ne è disposta la perquisizione, adottando misure tecniche dirette ad assicurare la conservazione dei dati originali e ad impedirne l'alterazione.
				\item[\textellipsis]
			\end{labeling}
			\item[Art. 352 c.p.p.] Perquisizioni
			\begin{labeling}{1.bis.}
				\item[\textellipsis]
				\item[1-bis.] Nella flagranza del reato, ovvero nei casi di cui al comma 2 quando sussistono i presupposti e le altre condizioni ivi previsti, gli ufficiali di polizia giudiziaria, adottando misure tecniche dirette ad assicurare la conservazione dei dati originali e ad impedirne l'alterazione, procedono altresì alla perquisizione di sistemi informatici o telematici, ancorché protetti da misure di sicurezza, quando hanno fondato motivo di ritenere che in questi si trovino occultati dati, informazioni, programmi informatici o tracce comunque pertinenti al reato che possono essere cancellati o dispersi.
				\item[\textellipsis]
			\end{labeling}
			\item[Art. 354 c.p.p.] Accertamenti urgenti sui luoghi, sulle cose e sulle persone. Sequestro.
			\begin{enumerate}
				\item [\textellipsis]
				\setcounter{enumi}{1}
				\item Se vi è pericolo che le cose, le tracce e i luoghi indicati nel comma 1 si alterino o si disperdano o comunque si modifichino e il pubblico ministero non può intervenire tempestivamente, ovvero non ha ancora assunto la direzione delle indagini, gli ufficiali di polizia giudiziaria compiono i necessari accertamenti e rilievi sullo stato dei luoghi e delle cose. \textbf{In relazione ai dati, alle informazioni e ai programmi informatici o ai sistemi informatici o telematici, gli ufficiali della polizia giudiziaria adottano, altresì, le misure tecniche o impartiscono le prescrizioni necessarie ad assicurarne la conservazione e ad impedirne l'alterazione e l'accesso e provvedono, ove possibile, alla loro immediata duplicazione su adeguati supporti, mediante una procedura che assicuri la conformità della copia all'originale e la sua immodificabilità.} Se del caso, sequestrano il corpo del reato e le cose a questo pertinenti.
				\item [\textellipsis]
			\end{enumerate}
		\end{description}
		La 48 del 2008 ha quindi, finalmente, introdotto nel codice di procedura penale la definizione di quello che qualche autore definisce ``il concetto di scena del crimine virtuale'' con conseguenti ispezioni e perquisizioni ``virtuali''. Viene introdotto il concetto di copia conforme all'originale del dato informatico e nonché la clausola dell'immodificabilità di quanto copiato.
		
		Addirittura, al secondo comma dell'art. 254 viene prescritta, in caso di urgenza, la copia forense in loco. Secondo il Ten.~Col.~Mattiucci del Ra.Ci.S. questa fattispecie configura una sorta di sequestro virtuale che ``\textit{è intrinsecamente irripetibile (come qualsiasi sequestro!). Infatti, anche nell'ipotesi di effettuare la copia sul posto nelle migliori condizioni possibili e con i migliori tool e le migliori metodologie se l'urgenza è giustificata l'attività non potrà essere ripetuta.}'' (Mattiucci).
		
		Il senso profondo delle novità introdotte dalla 48/2008 è, in sostanza, la necessità di adottare misure tecniche dirette ad \textbf{assicurare la conservazione dei dati originali e ad impedirne l'alterazione}.
		
		Il motivo è che ogni intervento su un sistema informatico non condotto in maniera forense comporta sempre e comunque una alterazione dei dati ivi presenti e la cancellazione di parte di essi, come insegnano casi eclatanti balzati agli onori della cronaca come, per citarne uno, l'omicidio di Garlasco.
		Per entrare nel dettaglio, le 4 fasi standard dell'indagine digitale forense sono (Mattiucci):
		
		\begin{enumerate}
			\item identificazione e prelievo;
			\item preservazione e archiviazione;
			\item analisi tecnica e investigativa;
			\item reporting tecnico e legale.
		\end{enumerate}
		
		Per gli scopi di questa esposizione, si approfondirà maggiormente il primo punto, trattando in maniera più rapida gli altri tre che, di norma, sono di competenza di organi e reparti specializzati o di personale in possesso di competenze specifiche.
		
		\section{Identificazione e prelievo:\\
			procedure operative per il repertamento digitale
			}
		
		Come accennato in premessa, non esiste un unico modo corretto per procedere al sequestro e alla successiva analisi di un reperto ad alta tecnologia, ma è comunque possibile fornire delle linee guide per evitare di commettere errori grossolani.
		
		In un mondo perfetto, le attività in argomento dovrebbero sempre essere svolte dallo stesso personale specializzato che poi si occuperà delle fasi successive dell'indagine forense in quanto, come si vedrà, già in sede di sopralluogo sarebbero necessarie competenze tecniche approfondite sia per evitare gli errori di cui sopra, sia per poter operare con cognizione di causa nel caso vi fosse la necessità di analizzare in loco le apparecchiature rinvenute accese. Purtroppo, nella maggior parte dei casi chi interviene è il personale del pronto intervento, della stazione di paese o, se si è fortunati, del Reparto Operativo che comunque non sempre ha la necessaria preparazione specifica. Per questi motivi è fondamentale che ogni operatore abbia almeno un'idea di base su come procedere al meglio.
		
		In generale, esistono due livelli di repertamento di un sistema digitale:
		
		\begin{enumerate}
			\item \textbf{il repertamento dell'oggetto fisico}, che mantiene i dati seguendo un qualche principio fisico (in genere elettrico, magnetico e/o ottico);
			\item \textbf{il repertamento dei dati} ossia la fedele copia dei dati su supporto sicuro.
		\end{enumerate}
		
		Di regola, il repertamento fisico precede quello dei dati in quanto il supporto (sia esso un computer intero o solo i dispositivi di archiviazione) viene inizialmente sequestrato sul posto e successivamente analizzato in sede o presso apposite strutture di terze parti. Tuttavia, si stanno diffondendo sistemi portatili che consentono di clonare il contenuto completo o parziale di un PC senza necessariamente prelevarlo e trasportarlo in un laboratorio specializzato e questo mentre continua a funzionare (si parla di live analysis).
		
		A ciò va aggiunto che molti dispositivi elettronici memorizzano i dati su memorie che hanno bisogno di batterie tampone o della corrente di rete per non perdere i dati in essi contenuti. Di converso molti altri dispositivi devono essere spenti forzatamente per garantire un buon repertamento (che cioè consenta poi un'analisi efficace).
		
		\subsection{Fissare le priorità}\label{sec:priorita}
		
		La scena del crimine è un puzzle che l'investigatore, siano o meno coinvolte tecnologie informatiche, deve riuscire a ricomporre. Ma la quantità di variabili e tasselli in gioco è sempre tale e tanta che, umanamente, non è possibile analizzare ogni singolo elemento: si devono stabilire delle priorità, in relazione alla tipologia di reato che si vuole e deve perseguire e al tipo di informazioni che si ritiene possano essere determinanti per l'indagine e, sulla base di tale scelta, selezionare gli elementi di interesse. 
		
		L'informatica è la scienza della gestione delle informazioni: la base di ogni sistema informatico e telematico sono i dati. Per questo motivo, all'investigatore che si trova a dover scegliere quali reperti siano prioritari rispetto ad altri deve essere ben chiaro il fine ultimo dell'attività di repertamento: raccogliere dati. Ora, nel perquisire il domicilio di un truffatore, di un pedofilo o di un terrorista, ci si deve chiedere dove possano essere immagazzinate le informazioni che si cercano: saremo di certo interessati ai dati contenuti nel suo computer ma, più probabilmente, le informazioni saranno archiviate altrove: perquisiamogli le tasche alla ricerca di chiavette USB (attenzione che queste ultime posso assumere le forme più strane, non ultime quelle di pupazzetti che nascondo un chip di memoria), guardiamo nei cassetti e cerchiamo di trovare dischi esterni o -- se il nostro cliente è un po' all'antica, informaticamente parlando -- CD-ROM o DVD. Se fosse ancora più tradizionalista, magari ha stampato delle foto o dei documenti: usciamo quindi dalle vesti dell'investigatore forense e rivestiamoci da sbirro di strada e cerchiamo album, raccoglitori, scatole da scarpe e vediamo se non ci sono nascosti dentro documenti interessanti.
		
		\textit{Di questa ``analisi delle priorità'' dovremo tenere conto sia in fase di sopralluogo e quindi di raccolta del materiale, sia in fase di esame tecnico forense.}
		
		\begin{figure}
		\begin{tikzpicture}[node distance=2cm]
		
		\node (start) [startstop] {Individuare il computer o il dispositivo da sequestrare};
		
		\node (pro1) [process, below of=start] {Mettere in sicurezza l'area e la scena del delitto facendo allontanare gli estranei dalle apparecchiature e dai quadri elettrici};
		
		\node (dec1) [decision, below of=pro1, yshift=-2cm, xshift=-5cm, text width=3cm ] {Il bersaglio è acceso?};
		
		\node (dec2) [decision, right of=dec1, xshift=8cm, text width=3cm] {C'è un esperto a disposizione?};
		
		\node (pro2) [process_red, below of=dec1, yshift=-7cm, text width=3.5cm] {NON ACCENDERLO!};
		
		\node (pro3) [process, below of=dec2, text width=3.5cm,  yshift=-7cm] {Seguire i suoi consigli};
		
		\node (pro4) [process_red, left of=pro3, text width=4cm, xshift=-3cm, yshift=6.5cm] {Non accettare consigli da sedicenti esperti};
		
		\node (pro4a) [process, below of=pro4, text width=5.5cm, yshift=-0.2cm] {Filmare, fotografare, prendere nota di tutto quello che è visibile a video e delle operazioni svolte};
		
		\node (pro4b) [process, below of=pro4a, text width=5.5cm, yshift=-1.5cm] {Rimuovere prima la batteria (se presente) e/o il cavo di alimentazione dall'apparato (e non dalla presa a muro o dalla ciabatta)};
		
		\node (pro5) [process, below of=pro4b, yshift=-1cm] {Etichettare e fotografare e filmare ciascun componente presente sulla scena, avendo cura di controllare anche come siano collegati i cavi delle periferiche esterne};
		
		\node (pro5a) [process, below of=pro5, yshift=.3cm] {Rimuovere i cavi di collegamento dalle rispettive prese a parete};
		
		\node (pro5b) [process, below of=pro5a] {Imballare con cura ciascun dispositivo ritenuto di interesse per le indagini, annotandone gli eventuali numeri di serie che andranno riportati nel verbale di sequestro. Gli imballi dovranno essere accuratamente etichettati.};
		
		\node (pro5c) [process, below of=pro5b] {Ricercare o richiedere alla parte in causa password e passphrase per accedere alle risorse};
		
		\draw [arrow] (start) -- (pro1);
		\draw [arrow] (pro1) -- (dec1);
		\draw [arrow] (dec1) -- node[anchor=east] {NO} (pro2);
		\draw [arrow] (dec1) -- node[anchor=south] {SI} (dec2);
		\draw [arrow] (dec2) -- node[anchor=west] {SI} (pro3);
		\draw [arrow] (dec2) -- node[anchor=south] {NO} (pro4);
		\draw [arrow] (pro4) -- (pro4a);
		\draw [arrow] (pro4a) -- (pro4b);
		\draw [arrow] (pro4b) -- (pro5);
		\draw [arrow] (pro2) -- (pro5);
		\draw [arrow] (pro3) -- (pro5);
		\draw [arrow] (pro5) -- (pro5a);
		\draw [arrow] (pro5a) -- (pro5b);
		\draw [arrow] (pro5b) -- (pro5c);


		\end{tikzpicture}
		\caption{La sequenza delle operazioni da svolgere nei casi più classici}
		\label{fig:diagrammaDiFlusso}
		\end{figure}
		\subsection{Procedure operative}
		
		Nel seguito verranno analizzati alcuni casi di studio utili per capire come operare in condizioni ottimali.
		
		\subsubsection{Caso 1: computer spento}
			Qualora sulla scena del crimine (o comunque sul luogo dell'eventuale perquisizione) sia presente un computer da sequestrare e lo stesso sia spento, siamo ovviamente nella condizione migliore.
			
			\textbf{Regola d'oro:} un computer spento non va MAI e poi MAI acceso.
			
			Dopo aver verificato che effettivamente sia spento (osservandolo accuratamente alla ricerca di LED o altre luci, ascoltando eventuali ventole attive, ecc.), si procederà a fotografare ed eventualmente video riprendere i componenti presenti, etichettandoli uno per uno (è buona prassi etichettare anche tutti i cavi che arrivano all'elaboratore). A quel punto è possibile rimuovere i cavi e cominciare ad impacchettare, sigillandone i plichi e applicando su ciascuno delle ulteriori etichette identificative, tutti i componenti di interesse.
			
			In questa fase è importantissimo annotarsi, magari fotografandone le etichette, tutti i numeri di serie o altre indicazioni presenti: tali codici identificativi andranno esplicitamente citati nel verbale delle operazioni e nel verbale di sequestro. 
			
			\begin{figure}
				\centering
				\includegraphics[width=1\linewidth]{pics/label1}
				\caption{La tipica etichetta sul fondo di un portatile}
				\label{fig:label1}
			\end{figure}
			
			È in questa fase che inizia la catena di custodia (\textit{chain of custody}) del materiale fisico: da questo momento in poi è fondamentale che ogni passaggio di mano delle fonti di prova sia cronologicamente documentato e tracciabile al fine di garantire l'integrità fisica dei supporti e dei dati in essi contenuti. Ogni operazione potenzialmente a rischio di compromettere tale integrità deve essere registrata e condotta in maniera conforme alle pratiche consolidate nel settore.
			Inutile aggiungere che, qualora si ritenga importante procedere anche ad un'analisi dattiloscopica sul materiale sequestrato, è indispensabile usare ogni cautela per evitare di disperdere eventuali impronte papillari dalle superfici latenti, utilizzando i normali guanti monouso e cercando di non ``strofinare'' gli oggetti.
			
			Sulla scena del crimine o nel locale sottoposto a perquisizione dovranno essere ricercate password e credenziali utili ad accedere al computer e ai dati: quindi sarà importante mettere in sicurezza agendine, post-it, appunti e ogni altro oggetto atto a registrare dati sensibili.
			
			All'indagato o comunque alla persona sottoposta alla perquisizione potrà essere chiesto di rivelare password, PIN o altre informazioni utili per accedere alle informazioni, tuttavia è importantissimo ricordare l'obbligo della P.G. di informare sul diritto a non rispondere sancito dagli artt. 60 co. 3 e 350 c.p.p: in caso di mancata informazione, il dato ottenuto sarà inutilizzabile.
			Su quest'ultimo punto vale sempre il brocardo latino \textit{``Nemo tenetur se detegere''}, ovvero nessuno può essere obbligato ad affermare o a fornire prova della propria responsabilità penale.
		

			In questa, come in tutte le situazioni esaminate nel seguito, va prestata massima attenzione alle modalità di imballaggio del materiale sequestrato. Non sarebbe utile a nessuno rientrare in sede con un computer il cui disco rigido si è danneggiato in fase di trasporto a causa di un imballo non accurato. Qualora si possa fin dal principio ipotizzare la necessità di sequestrare materiale informatico, è il caso di dotarsi preventivamente di idonei contenitori -- sono sufficienti anche degli scatoloni e dei giornali vecchi per creare una minima protezione agli urti. 

			
			In questa, come in tutte le situazioni esaminate nel seguito, va prestata massima attenzione alle modalità di imballaggio del materiale sequestrato. Non sarebbe utile a nessuno rientrare in sede con un computer il cui disco rigido si è danneggiato in fase di trasporto a causa di un imballo non accurato. Qualora si possa fin dal principio ipotizzare la necessità di sequestrare materiale informatico, è il caso di dotarsi preventivamente di idonei contenitori -- sono sufficienti anche degli scatoloni e dei giornali vecchi per creare una minima protezione agli urti. 
			
			Altra accortezza è quella di evitare di sottoporre il materiale sequestrato a campi elettromagnetici particolarmente forti, per scongiurare il rischio (peraltro solitamente remoto) di cancellazione accidentale dei dati.
		
			\subsubsection{Caso 2: computer acceso}\label{subsubsec:computer_acceso}
			Qualora il computer da sequestrare sia acceso, la situazione diventa più complicata. Un tempo si suggeriva di scollegare semplicemente il cavo si alimentazione (o staccare la batteria in caso di un portatile) e procedere al sequestro (come nel precedente caso 1).
			
			Tuttavia, nel tempo le \textit{best practice} si sono evolute e ora la regola è quella di prendere nota delle attività in corso nel computer al momento dell'intervento: tutto le relative informazioni vengono inesorabilmente perse scollegando l'alimentazione del sistema.
			
			Per fare ciò esistono vari metodi, dal più semplice (andare a vedere ``a mano'' che finestre sono aperte, quali pagine si stanno visualizzando, eventualmente quali processi sono attivi sulla macchina) al più elaborato (inserire una chiavetta USB con un software apposito).
			
			Qualsiasi sia la strada scelta, è fondamentale prendere nota di ogni attività svolta sul computer acceso, possibilmente filmando tutta l'attività e corredando il video di una accurata descrizione vocale di quanto si sta facendo, un po' come il detective dei film americani che nel corso di un sopralluogo utilizza un mini registratore per fissare le proprie impressioni su di un nastro, a futura memoria. 
			
			\paragraph{Ogni atto svolto con queste modalità è di natura assolutamente irripetibile!}
			
			Per una trattazione più dettagliata della questione ''live forensics'' si rimanda alla sezione \ref{sec:live_forensics}.
			
			\paragraph{Sincronizziamo gli orologi\dots}
			Tra le informazioni più importanti da annotare quando si procede a verificare un computer acceso va sempre letta l'ora e la data correnti del sistema, rapportandole a quelle effettive dell'intervento. Andrà annotato quindi qualcosa del tipo:
			
			\begin{itemize}
				\item Data e ora del sistema: 25 marzo 2013 ore 12:43:10;
				\item Data e ora dell'intervento: 25 marzo 2013 ore 12:40:57.
			\end{itemize}
			
			Tale operazione è di fondamentale importanza per permettere di mettere in relazione gli orari delle eventuali operazioni della P.G. con i dati che verranno estratti dall'analisi successiva del computer.
			
			\begin{figure}
				\centering
				\includegraphics[width=1\linewidth]{pics/dataora}
				\caption{L'ora del BIOS e quella di un tablet sincronizzata con NTP}
				\label{fig:dataora}
			\end{figure}

			
			Nell'esempio di cui alla figura \ref{fig:dataora}, è stata effettuata una foto della schermata del BIOS riportante data e ora del sistema, confrontata con quella indicata da un tablet sincronizzato con un NTP\footnote{Il Network Time Protocol, in sigla NTP, è un protocollo per sincronizzare gli orologi dei computer all'interno di una rete a commutazione di pacchetto. L'NTP è uno dei più vecchi protocolli tuttora in uso, ed è giunto alla sua quarta versione. Fu sviluppato presso l'Università del Delaware da Dave Mills, che ne segue tuttora lo sviluppo. Il funzionamento si basa sul rilevamento dei tempi di latenza nel transito dei pacchetti sulla rete. Utilizza il tempo coordinato universale ed è quindi indipendente dai fusi orari. Attualmente è in grado di sincronizzare gli orologi dei computer su internet entro un margine di 10 millisecondi e con una accuratezza di almeno 200 microsecondi all'interno di una LAN in condizioni ottimali. (\url{https://it.wikipedia.org/wiki/Network_Time_Protocol})} server: tablet e monitor sono stati immortalati nella stessa foto.
			
			È buona norma per l'operatore essere in grado di avere l'ora esatta, magari appunto installando una applicazione di sincronia NTP sul proprio telefono.
			
			A margine, è bene ricordare che l'ora del BIOS non necessariamente è l'ora del sistema operativo. Nel caso di computer acceso, si dovrà confrontare l'ora del sistema operativo con l'ora corrente, mentre in caso di computer spento, presa l'ora del BIOS, in sede di analisi forense deve essere verificata l'impostazione dell'orologio del sistema, ovvero su quale fuso è impostata e se lo stesso prende per buona l'ora hardware o vi applica una correzione corrispondente al fuso orario.
			
			\paragraph{Approfondimenti sui sistemi accesi}
			\subparagraph*{Perché è importante verificare l'attività in corso sul computer prima di spegnerlo e sequestrarlo?}
			
			Rispetto a qualche anno fa, il modo in cui i programmi e gli utenti interagiscono con il computer è molto cambiato. Senza che l'utente prenda accorgimenti particolari, molti dettagli (che a volte si rivelano fondamentali) dell'attività in corso non vengono salvati (la chat di facebook, ad esempio); esistono poi sistemi, quali la cosiddetta modalità di navigazione anonima, che servono proprio a non lasciare alcuna traccia delle pagine visitate.

			Questo tipo di dati, importantissimi per documentare le ultime attività, andrebbero persi se non visionati prima di spegnere il sistema.
			
			\subparagraph*{A cosa serve documentare l'attività e perché è così importante?}
			Può certamente sembrare una domanda banale, ma viste le più o meno recenti notizie di cronaca su clamorosi errori svolti dalla Polizia Giudiziaria sul luogo del delitto, è meglio ribadire il concetto.
			
			Come già sottolineato, quasi ogni attività fatta su un dispositivo ad alta tecnologia, tipicamente su un computer, lascia una traccia che un buon analista forense è in grado di trovare, seguire e interpretare. Per l'analisi successiva al sequestro è importante che il tecnico sappia distinguere le attività dell'utilizzatore del computer da quelle svolte dagli operatori al momento del sequestro. 
			
			Anche documentare gli orari esatti di queste attività è importante: ipotizzando che la data e l'ora del sistema siano esatte (e se non lo sono sia comunque possibile stabilire di quanto si discostano da quelle effettive, come visto nel paragrafo ``Sincronizziamo gli orologi\dots''), si potranno distinguere le operazioni fatte in corso di ``live forensics'' dagli operatori sulla scena del crimine da quelle svolte, anche solo pochi minuti prima, dall'eventuale autore del delitto che poi si sia dato alla fuga.
			
			Inoltre, sapere con certezza quali operazioni sono state svolte dalla Polizia Giudiziaria è fondamentale anche in sede dibattimentale, per evitare che di quelle eventuali azioni -- non documentate in alcun atto di indagine -- si accorgano i periti di parte: in questo caso la figuraccia degli operatori è assicurata, come insegna il caso di Garlasco.
			
			\paragraph*{}
			È evidente che non tutti gli operatori sono degli informatici o hanno conoscenze informatiche di alto livello. Anche qui ci deve aiutare il buon senso: le operazioni devono essere effettuate nei limiti delle proprie conoscenze tecniche, evitando di compromettere i dati se non si è sicuri di quello che si sta facendo. Nel dubbio, se non si riesce a contattare nell'immediatezza un tecnico di accertata competenza -- senza ascoltare i consigli di sedicenti tali -- dopo aver filmato quanto si riesce a vedere, è giunta l'ora di staccare il cavo dell'alimentazione del computer. Da lì in poi, il reperto può essere trattato come nel caso 1: in effetti, adesso, il sistema è spento!
			
			\emph{Va sempre ricordato al personale che per spegnere il computer da repertare per una successiva analisi forense non si deve MAI effettuare la procedura di arresto prevista dal sistema operativo in quanto questa operazione scrive sul disco e altera i dati: va semplicemente staccata la spina o rimossa la batteria.}
			
			\subsubsection{Caso 3: server o altra apparecchiatura di rete}
			
			In un caso particolare quale quello del sequestro disposto dei confronti di un server di rete, occorre procedere con i piedi di piombo e cercare di capire, e fare capire al magistrato se necessario, se l'apparecchiatura in questione sia o meno nella completa disponibilità dell'indagato: i server di solito ospitano più di un utente e i dati di ciascuno sono ermeticamente separati tra loro. Sequestrare un intero server per accedere ai dati di un solo utente sarebbe come porre sotto sequestro un intero palazzo da 20 appartamenti per effettuare i rilievi su uno solo di essi, dove magari è avvenuto un omicidio: certo, con il server è fisicamente più facile, ma il danno creato agli utenti ``innocenti'' dello stesso server è analogo a quello di sgombrare 20 famiglie per accedere ad uno solo appartamento.
			
			Come sempre, qualora non si sia in grado di operare correttamente, è opportuno richiedere l'intervento di personale specializzato, o almeno chiedere all'amministratore del server di estrapolare, con tutti gli accorgimenti di una indagine forense, i dati dell'utente di nostro interesse.
			
			\paragraph*{Un esempio per assurdo}
			
			Per accedere ai dati di un solo utente \textit{facebook} non chiederò a quell'azienda i dati di milioni di utenti, ma solamente di quello specifico di mio interesse. Un server di una piccola azienda funziona, di fatto, allo stesso modo, sebbene su scala un po' più piccola: di volta in volta è necessario valutare se serve davvero sequestrare tutto il server o chiedere all'amministratore una copia dell'area di lavoro del nostro \textit{target}.
			
			A parere di chi scrive, la prassi purtroppo spesso invalsa di sequestrare, nel dubbio, tutto per poi scremare \textit{a posteriori} può andare bene per i computer e le apparecchiature tecnologiche di una privata abitazione: fermare però l'attività di un'azienda intera, magari terza rispetto alle attività criminali di un dipendente o di un cliente, dimostra una mancanza di professionalità. Come in tutte le attività di P.G. che abbiano natura invasiva, è necessario procedere chirurgicamente, limitando al massimo i ``danni collaterali'' arrecati a chi sia estraneo alle attività illecite.
			
		\subsection{Come operare con dispositivi mobili (\textit{telefoni, smartphone e tablet})}
			L'evoluzione tecnologica degli ultimi anni ha fatto sì che i dispositivi mobili siano diventati sempre più simili a computer e sempre meno a semplici dispositivi di comunicazione quali erano invece i vecchi cellulari.
			
			In effetti ormai gli \textit{smartphone} e i \textit{tablet} hanno capacità di archiviazione pari, normalmente, ad uno o due ordini di grandezza in meno di quelli di un ordinario personal computer: si parla per tanto, mediamente, di 32 o 64 gigabyte per i modelli di punta e di non meno di 4-8 gigabyte per i modelli più economici.
			
			Come per i computer, anche per i dispositivi mobili le modalità di sequestro necessitano di alcuni accorgimenti particolari. 
			
			\subsubsection{Dispositivi rinvenuti accesi}
			In caso di rinvenimento degli apparecchi accesi, è indispensabile verificare, se possibile, l'attività in corso al momento, annotando l'ora e la data impostate in rapporto a quelle reali. Non devono essere effettuate per nessun motivo chiamate e, se la situazione lo richiede per motivi di urgenza e in assenza dello specialista, è possibile prendere nota delle ultime chiamate effettuate e ricevute, visionando la rubrica nonché eventuali SMS o MMS ricevuti. Tutte queste operazioni devono essere fatte senza spostare il dispositivo da dove si trova, per evitare di cambiare la cella agganciata al momento del rinvenimento.
			
			Se si dispone di tale accessorio, è opportuno operare quanto sopra descritto solo dopo aver messo il dispositivo in un idoneo involucro che funga da gabbia di Faraday per evitare che si colleghi alla rete mobile.
			
			Per spegnerlo è necessario staccare la batteria, solo però dopo aver preso nota delle informazioni di cui sopra (che, una volta disconnessa la batteria vengono inevitabilmente perse).
			
			A questo punto si può procedere con le ulteriori attività, descritte di seguito per i sistemi non attivi al momento del rinvenimento.
			
			\subsubsection{Dispositivi spenti}
			Come sempre, vale la regola di non accendere mai gli apparecchi rinvenuti spenti. Prima di imballarlo, vanno ricercate e sequestrate a parte eventuali SIM card e schede di memoria contenute nel telefono, delle quali vanno annotati numeri di serie e ogni altro dato utile.
			
			Il numero IMEI del telefono (ovvero il numero identificativo univoco del terminale) è solitamente indicato su un etichetta posta sulla scocca al di sotto della batteria: pertanto è necessario, dove possibile, rimuoverla per poter annotare l'IMEI: tale operazione, su un terminale rinvenuto spento, ha il grosso svantaggio che azzera i dati della memoria volatile del telefono, quali le chiamate recenti e le impostazioni di data e ora.
			
			Se non indispensabile, l'annotazione del numero IMEI può anche essere fatta successivamente, in corso di analisi forense, salvo ragioni di urgenza e necessità facciano optare invece per una scelta diversa.
			
			\begin{figure}
				\centering
				\includegraphics[width=1\linewidth]{pics/samsung_example}
				\caption{Un semplice telefono di vecchia generazione fornisce già molti dati...}
				\label{fig:samsung_example}
			\end{figure}

			
			Quando possibile, è necessario cercare di reperire ogni utile codice di accesso al telefono, PIN e PUK in primo luogo, ma anche eventuali altri codici di sblocco che possono precludere in modo assoluto l'accesso al telefono.
			
			Le analisi forensi sui telefono di nuova generazione sono generalmente non ripetibili. Sui motivi e le implicazioni di questa affermazione ci si soffermerà nel seguito.
			
		\subsection{Un caso di studio: esiste la ``perquisizione informatica''?}\label{subsec:perquisa_informatica}
		
		Su attivazione di una Stazione Carabinieri, personale del Nucleo Operativo di Compagnia riusciva ad intercettare un'auto con a bordo presunti truffatori che, per un maldestro intervento del personale della Stazione, avendo notato l'arrivo dell'auto con i colori d'istituto, si stavano dileguando senza perfezionare la truffa. 
		
		Il loro modus operandi era piuttosto semplice: in un grosso centro commerciale ordinavano un buon quantitativo di materiale elettronico, per valori tra i 3 e i 4 mila euro. Ottenuto il preventivo, dicevano che si sarebbero recati in banca per ottenere un assegno circolare e nel frattempo chiedevano che fosse preparata la merce. Dopo le 4 del pomeriggio, quando oramai le banche erano chiuse, si ripresentavano con un assegno non trasferibile dell'importo pattuito, ritiravano la merce e si dileguavano. Ovviamente l'assegno era falso, ma l'esercente lo poteva appurare solo il giorno successivo.
		
		L'errore dei malviventi era stato quello di operare sempre in filiali della stessa catena (Mercatone Uno) usando documenti validi: la direzione centrale, dopo l'ennesima truffa, aveva diramato le foto dei truffatori, dando la possibilità ai commessi che, nel caso in esame stavano per essere truffati, di chiamare i Carabinieri.
		
		Quindi i colleghi del Nucleo Operativo, identificata l'auto con la quale i truffatori si stavano dileguando, riescono a fermarla e nel corso di una ispezione al veicolo trovano, in uno scatolone, un computer portatile, una stampante e un \textit{inverter} da campeggio, per collegare il tutto all'impianto elettrico della macchina.
		
		Il magistrato di turno, sulla base dei pochi elementi in possesso, non autorizza la perquisizione del veicolo (problema ovviato con una semplice ispezione) né tanto meno il sequestro del computer. Il PM propone quindi agli operatori di effettuare una perquisizione informatica del computer, alla presenza di un avvocato d'ufficio nominato al momento.
		
		Avviene così che giunti in caserma e, atteso l'avvocato, viene effettuata la perquisizione del computer. 
		
		Come si è proceduto? Come per una normale perquisizione, alla presenza del difensore, chiedendo dapprima all'indagato se spontaneamente volesse fare vedere dove fossero i file con gli assegni da stampare. Ovviamente l'interessato ha negato la presenza di qualsiasi file di quel tipo. A quel punto, prendendo nota di data e ora corrente e di ogni operazione fatta, i militari hanno acceso il computer. Subito si è andati alla ricerca dei ``file recenti'': nella corrispondente voce del menu era presente un file dal nome significativo: ``serialef.psd''. Si tratta di un file grafico dell'applicativo \textit{Photoshop}. 
		
		\paragraph{Perchè si è andati alla ricerca proprio dei file recenti?} Non c'è un motivo preciso, è stato l'intuite degli investigatori sul momento. Avrebbero potuto prima guardare nella cartella \texttt{Documenti}, nelle foto, aprire la lista delle applicazioni. Tuttavia, in quel momento si ipotizzava che il truffatore avesse usato nel recentissimo passato il computer per produrre un assegno: la cosa più logica è sembrata quella di guardare nella cartella dei Documenti recenti. E, per una volta, la fortuna è stata dalla parte dei buoni!
		
		\paragraph{} Purtroppo non è stato possibile aprire il file in quanto era solo un \textit{link} che faceva riferimento ad una cartella contenuta in una memoria rimovibile (forse una penna USB): tuttavia questo indizio, per quanto lieve, era più che sufficiente per chiudere la perquisizione e procedere al sequestro, al fine di effettuare una analisi forense approfondita alla ricerca di eventuali tracce di assegni contraffatti.
		
		A dimostrazione della fondatezza dell'ipotesi, nel corso della analisi forense è stato rinvenuto, tra i file cancellati, proprio un file PSD che raffigurava un assegno (figura \ref{fig:assegno_psd})
		
		\begin{figure}
			\centering
			\includegraphics[width=1\linewidth]{pics/assegno_psd}
			\caption{L'assegno contraffatto rinvenuto tra i file cancellati}
			\label{fig:assegno_psd}
		\end{figure}

		
		Le supposizioni degli investigatori sono state quindi suffragate da quanto rinvenuto nel disco fisso del computer.
		
		La risposta quindi alla domanda posta nel titolo del paragrafo ``esiste la perquisizione informativa'' è sì: di volta in volta la PG, di concerto con l'A.G., valuta come operare su un computer. Di fatto, quello che è stato fatto nell'esempio descritto non è altro che una perquisizione, irripetibile ma documentata, dell'apparecchiatura informatica.
		
		\emph{Un'altra regola da non dimenticare mai, che vale non solo nelle perizie informatiche ma in tutte le situazioni in cui la P.G. debba fare un sopralluogo, è che ogni attività, ogni operazione svolta deve essere debitamente, puntualmente e accuratamente documentata.}
		
		\paragraph{In caso di errore, deve essere documentato?} La risposta breve è semplice: sì! Ma per quale motivo non è sempre chiaro: molti tendono a nascondere gli errori, certamente per orgoglio o vergogna. Ma nell'attività di P.G. gli errori possono capitare (non si dice che solo chi non lavora non commette errori?) e documentarli è fondamentale
		
	\section{L'analisi forense}
	
		Fatte le premesse sulle corrette modalità di repertamento del materiale informatico, è necessario spendere qualche parola sull'analisi vera e propria, quella che alla fine fornisce le prove dell'eventuale attività illecita condotta per il tramite di uno o più dispositivi tecnologici.
		
		Come per la fase di repertamento, anche nel corso dell'analisi forense le capacità e l'intuito dell'investigatore sono fondamentali: come già detto, nessun tecnico, per quanto bravo, può sostituirlo. In quest'ottica, sarebbe sempre opportuno che le forze di polizia formassero propri operatori dedicati alle operazioni di analisi, in modo da garantire non solo le competenze tecniche ma anche la giusta impostazione mentale.
		
		In generale, la fase di analisi dei dati contenuti nelle apparecchiature che sono state sequestrate compete al personale appositamente formato (vedi sopra) o, in alternativa, a tecnici esterni nominati all'uopo. Tuttavia, può capitare che, per ragioni di urgenza o di economicità, si debba operare in autonomia, al meglio delle proprie competenze.
		
		Lo scopo di questo piccolo excursus sulle analisi forensi non è quello di essere esaustivo, quanto piuttosto di dare un'idea di quelle che sono le possibilità per gli operatori. La materia è vasta richiede certamente più tempo per essere approfondita in maniera adeguata.
		
		\subsection{I principi dell'analisi forense}
		
		Nel corso dell'analisi del materiale sequestrato, si devono tenere a mente alcuni punti cardine: rispettandoli, chiunque può approcciarsi all'analisi e tentare di estrapolare i dati senza rischiare di invalidare la prova e comprometterne utilizzi futuri.
		
		\begin{enumerate}
			\item \textbf{tracciabilità della catena di custodia (\textit{chain of custody}) dei reperti}: ogni passaggio di mano, ogni apertura dei plichi sigillati, ogni operazione svolta deve essere registrata;
			\item \textbf{integrità dei dati}: in nessun momento dell'analisi devono essere in alcun modo modificati i dati contenuti nei reperti;
			\item \textbf{verificabilità e ripetibilità di tutte le operazioni svolte}: chiunque deve essere in grado di riprodurre, avendo gli strumenti adeguati, le operazioni svolte nell'analisi ottenendo gli stessi risultati.
		\end{enumerate}
		
		Di seguito esamineremo gli aspetti salienti dell'analisi forense che sono alla portata della maggior parte degli operatori: non è necessario essere un ingegnere informatico per fare un'analisi forense di massima, ma certamente chi si trova ad eseguirla deve avere delle conoscenze informatiche che vanno oltre quelle di chi si limita ad utilizzare suite da ufficio o a navigare su internet.
		
		\subsection{Competenze richieste a chi si vuole avvicinare al Digital Forensics}
		Come accennato, non basta saper usare bene un computer per riuscire a mettere in atto una analisi forense, fosse anche solo preliminare nell'attesa dell'arrivo di un tecnico.
		
		Le conoscenze richieste sono, in ordine di importanza:
		
		\begin{enumerate}
			\item Concetto di memoria volatile e persistente;
			\item Architettura hardware di un computer;
			\item Concetto di BIOS\footnote{In informatica, il Basic Input-Output System o BIOS è un insieme di routine software, generalmente scritte su memoria ROM, FLASH o altra memoria non volatile, che fornisce una serie di funzioni di base per l'accesso all'hardware del computer e alle periferiche integrate nella scheda madre da parte del sistema operativo e dei programmi. Nei computer IBM-compatibili la ROM del BIOS contiene anche il POST, il primo programma che viene eseguito dopo l'accensione, coinvolto dunque nella fase di avvio (boot) del sistema di elaborazione. (\url{https://it.wikipedia.org/wiki/BIOS})};
			\item Concetto di periferiche e memorie di massa;
			\item Concetto di \textit{hash};\footnote{Nel linguaggio matematico e informatico, l'\textit{hash} è una funzione non iniettiva (e quindi non invertibile) che mappa una stringa di lunghezza arbitraria in una stringa di lunghezza predefinita. Esistono numerosi algoritmi che realizzano funzioni hash con particolari proprietà che dipendono dall'applicazione.\url{https://it.wikipedia.org/wiki/Hash}. Sull'importanza e l'utilizzo dell'\textit{hash} si ritornerà nel seguito del presente testo.}
			\item Architettura base dei sistemi operativi Microsoft (cartelle di sistema, cartelle utente, file temporanei);
			\item Architettura base dei sistemi Apple (idem);
			\item Funzionalità base dei sistemi GNU/Linux (per l'utilizzo dei tool per il ``\textit{live forensic}'').
			
		\end{enumerate}

		\subsection{L'analisi \textit{post mortem}}
			Quando si deve analizzare il contenuto di una memoria di massa in laboratorio ci si trova in una situazione analoga a quella di un medico legale che esamina un cadavere, con i debiti distinguo. Per questo motivo spesso si parla di analisi \textit{post mortem}.
		
			Per le finalità della presente trattazione, è sufficiente descrivere sommariamente i passaggi e gli strumenti utilizzati dai tecnici chiamati ad operare, non fosse altro che per saper valutare la professionalità e la preparazione di chi si ha di fronte, anche solo scambiandoci due parole.
		
		
			\subsubsection{Non tutti gli informatici o presunti tali sono esperti forensi}\label{subsec:bad_examples}
				Il primo esempio che salta alla mente è quella del referente telematico di un reparto dell'Arma dei Carabinieri: per quanto bravo e professionale nel suo lavoro, nonostante certificazioni Microsoft o di altri enti, non necessariamente egli ha chiari i concetti che stanno alla base dell'analisi forense di un sistema. Spesso, comunque, anche sedicenti esperti esterni non sono affatto tali. Vediamo qualche caso realmente accaduto.
		
				\paragraph{Un primo esempio\dots} 
					Non molti anni fa, un Comandante Provinciale propose al Comandante di una Compagnia alle sue dipendenze di fare effettuare l'analisi forense al referente informatico provinciale: fortuna volle che ne fu informato lo scrivente, allora Comandante del locale Nucleo Investigativo che ``interrogò'' il collega informatico. Richiesto sulle modalità con le quali il referente avrebbe affrontato il problema della copia del materiale informatico sequestrato, questi candidamente ammise che avrebbe collegato il disco rigido del computer alla propria macchina e "trascinato tutte le cartelle presenti" sul disco acquistato all'uopo dalla Procura. A quel punto, gentilmente ma fermamente, chi scrive disse al Comandante Provinciale e al Comandante della Compagnia che probabilmente avevano individuato la persona sbagliata per quell'attività. A breve vedremo perché.
			
				\paragraph{\dots e un secondo} 
					Nella stessa sede, su indicazione di un magistrato, il Nucleo Investigativo consegnò ad un sedicente esperto forense il computer di un uomo trovato morto in casa, sospettando che il decesso fosse avvenuto a causa dell'assunzione di farmaci anabolizzanti illegali acquistati in rete. Dopo qualche settimana, il perito si presentò con una relazione di 15 pagine, metà delle quali erano occupate da schermate di "esplora risorse" di Windows Vista nelle quali si vedevano le cartelle presenti nel disco rigido. Nessuna menzione di come il disco era stato collegato al computer, nessuna traccia di \textit{hash} ma soprattutto nessuna analisi! Era stato sostanzialmente verificato con estrema superficialità il contenuto del disco, senza però aprire i file. Per non parlare, ovviamente, dell'analisi dello spazio non allocato, cioè dei file cancellati.
					
					Lo stesso perito era stato chiamato ad esaminare il computer di un presunto pedofilo in un'altra Compagnia dello stesso Provinciale. Non stupì il sottoscritto il fatto che non fosse stato trovato nulla di utile. Alla luce della pessima esperienza con la \textit{non-}analisi, il magistrato chiese del materiale con il quale, suo malgrado, fu costretta a demolire il lavoro del proprio stesso CTU il quale, rendendosi conto di aver fatto un pessimo lavoro e soprattutto una magra figura, uscì dall'aula del tribunale in lacrime.
			
			\subsubsection{La copia forense}
				Prima ancora di iniziare a analizzare il contenuto di un computer o comunque di un dispositivo digitale con al suo interno dei dati immagazzinati, è necessario effettuarne una \textbf{copia forense}\footnote{\url{https://it.wikipedia.org/wiki/Copia_forense}} (in inglese \textit{forensically sound image}). A differenza di quanto proposto dal referente telematico del primo esempio del paragrafo \ref{subsec:bad_examples} e di quanto fatto dal perito del secondo, \emph{una copia forense non è una copia effettuata ``trascinando'' le cartelle del disco oggetto di analisi in quello destinato a contenerne la copia}. 
				A differenza di una copia eseguita sui singoli file presenti sul filesystem, la clonazione comporta la duplicazione di tutte le zone del disco, anche quelle che non contengono alcun file direttamente visibile all'utente, definite tecnicamente aree non allocate. Poiché nella maggior parte dei filesystem la rimozione di un file implica semplicemente la cancellazione dell'indice che contiene la posizione del file su disco, il poter aver accesso alle aree non allocate permette il recupero di file cancellati o di informazioni ormai non più disponibili all'utilizzatore del sistema. La copia forense è realizzabile tramite clonazione o tramite creazione di un file immagine.
				Effettuare un copia in questo modo necessita alcuni accorgimenti tecnici semplici ma fondamentali che né il referente né il perito dei precedenti esempi avevano anche solo minimamente tenuto in considerazione: \textbf{la protezione in scrittura del disco da copiare.}
				
				Per ottenerla ci sono due possibilità:
				\begin{enumerate}
					\item avere a disposizione un dispositivo che faccia il blocco a livello hardware (\textit{write blocker} (figura \ref{fig:800px-Portable_forensic_tableau}))
				\end{enumerate}
				
				\begin{figure}
					\centering
					\includegraphics[width=0.7\linewidth]{pics/800px-Portable_forensic_tableau}
					\caption{Un esempio di write blocker hardware}
					\label{fig:800px-Portable_forensic_tableau}
				\end{figure}


				
				
		
		\subsection{Live Forensics}\label{sec:live_forensics}
			La procedura che per anni è stata considerata come la migliore possibile è quella del repertamento ``brutale'' del personale computer: essa richiede che il dispositivo sulla scena del crimine venga spento senza che il sistema operativo registri l'evento ``spegnimento'', interrompendo semplicemente l'alimentazione elettrica.
		
			Tale procedura è nata dalla consapevolezza che il personale impiegato nelle attività non è specializzato nel repertamento fisico e nel sequestro di piccoli sistemi computerizzati. Come accennato nella sezione \ref{subsubsec:computer_acceso}, lo spegnimento forzato determina perdite di dati, principalmente di quanto contenuto nella RAM, ma un tempo si riteneva che il costo di queste perdite fosse minimo rispetto al rischio di far interagire un NON specialista con la macchina per ottenere direttamente informazioni. Inoltre, in questo modo si riesce a ridurre un minimo la sovrascrittura dei dati cancellati sulle memorie di massa attive.
			
			Tuttavia, nel tempo, la complessità anche dei piccoli sistemi, nonché quella --scontata-- di quelli grandi (come i server aziendali), ha reso sempre meno trascurabile la perdita di dati causati dallo spegnimento forzato, comportando la distruzione di fonti di prova spesso determinanti.
			
			Molte delle possibili prove presenti nella memoria RAM non vengono registrate sui supporti persistenti:
		
			\begin{enumerate}
				
				\item{\textbf{comunicazioni con dati non persistenti,}} come le chat, sussistono per la massima parte in RAM e quindi la loro degradazione nello spegnimento forzato è pressoché totale;
				\item{\textbf{crittografia}}: possono esistere protezioni    crittografiche per intere partizioni che, al momento dell'impiego della macchina, sono abbassate per evidenti necessità di impiego della memoria di massa; allo spegnimento del sistema l'accesso alla partizione criptata può risultare complicata se non impossibile, richiedendo di solito l'immissione di una password o di una passphrase.
				\item{\textbf{server:}} per grandi sistemi l'idea di spegnerli per repertare è frutto solo dell'ignoranza. Le costruzioni dati che possono risultare all'interno dei server sono in generale così complesse che, pensare di repertare dei dati in maniera raw per poi ricostruirli in maniera sensata e completa, determina un problema impossibile da risolvere;
				\item{\textbf{necessità}} di analizzare qualsiasi servizio o applicazione attivo sulla macchina.
			\end{enumerate}
		
			È necessario quindi, in queste condizioni, accedere alla macchina direttamente con competenza e prontezza.
			
			Se si ammette la possibilità di interagire sulla scena del crimine con la macchina, si accetta che:
			\begin{itemize}
	
			\item il repertamento dei dati sia parziale e incompleto;
			
			\item alcuni dati di interesse possano emergere durante l'interazione con la macchina per cui il repertamento dati avviene a fasi incrementali.
			
			\item preparazione ed analisi siano ridotti al minimo durante l'interazione con il sistema proprio per diminuire la possibilità di causare cambiamenti troppo importanti nelle memorie digitali in analisi e lasciare la parte approfondita di essi all'approccio statico.
			
			\item il \textit{reporting} non sia quello del \textit{forensic} statico, che si propone di spiegare le operazioni in dettaglio e presentarle in dibattimento.
			Si tratta di una sorta di perquisizione, con o senza la presenza dell'indagato, simile a quella descritta nel paragrafo \ref{subsec:perquisa_informatica}.
		
		\end{itemize}
		
		È importante sottolineare che le attività principali dal punto di vista tecnico nel \textit{computer forensics} ``statico'', ossia preparazione ed analisi, divengono minime nell'attività live.
		Mentre l'approccio statico tende a generare attività \textbf{ripetibili} dal punto di vista sia tecnico che legale, le attività \textit{live} sono intrinsecamente irripetibili, da cui l'assoluta necessità di un affidabile \textit{reporting}: tutte le operazioni effettuate devono essere dettagliatamente documentate.
		
		L'irripetibilità del \textit{live forensic} è:

		
		\begin{itemize}

		\item \textbf{di natura tecnica: }non esiste infatti possibilità di realizzare analisi e repertamento dati live senza modificare almeno una parte della memoria del sistema.
		
		\item \textbf{di natura temporale:} la situazione della macchina all'atto dell'attività è frutto del momento e la sua complessità è tale da non poter essere riprodotta.
		
		\item \textbf{relativo all'osservabilità:} lo stato di un computer reperto attivo, in tutte le sue variabili, non è completamente osservabile perché la sonda che si dovrebbe inserire per compiere tale osservazione andrebbe a modificarne proprio lo stato (un concetto analogo a quello del \textit{paradosso del gatto di Schroedinger}).
		\end{itemize}
		
		\subsubsection{Acquisire le prove}
		
		In questo neo-settore del \textit{digital forensics} non esistono training assestati validi per l'Italia; l'elemento essenziale è attualmente la preparazione tecnico/legale della persona che opera e la sua capacità d'impiego e realizzazione di strumenti adatti all'ambito legale di applicazione.
		
		Alcune regole di massima riguardano il fare attenzione allo stato evidente della macchina e quindi screen saver attivi, la lista dei processi, l'alimentazione elettrica, la presenza di crypto-system, le periferiche e le connessioni wired/wireless presenti.
		
		Le pratiche più importanti di cui tener conto per massimizzare la qualità delle prove sono:
		
		\begin{itemize}
			\item{\textbf{running known good binaries}}: un investigatore non dovrebbe affidarsi agli eseguibili del sistema su cui va a operare ma dovrebbe fornire lui stesso gli eseguibili per raccogliere le prove. Questi eseguibili possono essere copiati sul sistema, anche se questa azione potrebbe sovrascrivere alcune prove. Tuttavia, se la scelta deve essere tra perdere alcune prove e non ottenerne affatto, è meglio rischiare;
		
			\item{\textbf{hashing all evidences:}} una volta acquisita, la prova deve essere preservata in modo tale che l'investigatore possa, più tardi, dimostrare che nulla è cambiato. Il metodo più accettato è quello di calcolare un \textit{hash} dei dati (solitamente via MD5 o SHA-1). L'\textit{hash} rappresenta una ``impronta digitale'' dei dati con un piccolo numero di byte, solitamente 16-20. L'\textit{hash} può essere ricalcolato più tardi e comparato con l'originale per mostrare che i dati non sono cambiati da quando è stato calcolato il primo valore;\footnote{Al riguardo, a parere di chi scrive, ci sarebbe da discutere: nel fare una attività di \textit{live forensic} tutti i file estrapolati sono suscettibili di essere stati manipolati. Un eventuale \textit{hash} di un file salvato da un computer acceso è essenzialmente autoreferenziale. Salvo che quello stesso file venga trovato anche in sede di analisi \textit{post mortem} la difesa non avrà modo di risalire e ricostruire le operazioni che hanno portato al suo rinvenimento. Ben venga l'hashing di tutte le evidenze rinvenute, ma a quale scopo?}
		
			\item{\textbf{gathering data in order of volatility:}} alcuni dati sono più effimeri di altri. Le prove dovrebbero essere raccolte in base ad un ``ordine di volatilità'':per esempio, la stampa della memoria fisica di una macchina potrebbe essere utile, potrebbero volerci pochi minuti per completarla, ma nel frattempo molte più utili informazione potrebbero andare perse o potrebbero essere modificate (processi attivi, file aperti, connessioni di rete, \dots). 
			In altre parole, l'investigatore deve tener conto del contesto dell'investigazione nella sua totalità, in modo da prendere decisioni informate sull'ordine di acquisizione delle prove. Al riguardo, si veda la sezione \ref{sec:priorita}~``\nameref{sec:priorita}''.
		
		\end{itemize}
		
		L'acquisizione dei dati può avvenire in diversi modi:
		
		\begin{enumerate}
			\item \textbf{computer forense collegato a reperto tramite connessione ethernet:} vi è la necessità di configurare il reperto per la connessione (firewall, privilegi..), il vantaggio è che si può operare dall'esterno per la massima parte e lo scaricamento dati può essere piuttosto semplice.
			\item \textbf{drive esterni:} si sfruttano le connessioni USB del reperto per connettere una memoria di massa o un file server esterno. Il vantaggio è che procurarsi memorie di massa esterne è in generale semplice e poco costoso, purtroppo però in questa operazione si deve impiegare il reperto direttamente per tutta l'attività (pericoloso!)
			\item \textbf{ripresa video o printscreen:} in genere vengono usati come elemento aggiuntivo ad uno dei due precedenti o sostitutivo dei seguenti
			\item \textbf{altri metodi estremi} (non validissimi ma impiegabili in caso di urgenza e di non necessità di impiego dei dati ricavati in dibattimento): masterizzare un CD/DVD sul reperto, salvare i dati presenti nella RAM sull'hard disk del reperto.
		\end{enumerate}
		
		\subsubsection{Analisi -- Mettere tutto assieme}
		
		Una volta che le prove sono state acquisite, devono essere analizzate. È spesso impensabile raccogliere tutte le possibili informazioni disponibili in un'esame ``live''.
		
		Un investigatore deve quindi stilare un triage (elenco di priorità, giusto per ripetere un concetto importantissimo) per raccogliere i dati essenziali, esaminarli, e usare i risultati per decidere, a colpo d'occhio, quali altre prove sono necessarie.
		
		Quindi, per la live forensic,  i passi dell'analisi devono condurre ad una rapida acquisizione dei dati. L'analisi ``live'' crea l'opportunità per un responso più rapido.
		
		\subsubsection{Qualche esempio di strumenti per la live forensic}
		Come per le analisi forensi tradizionali, lo scrivente è fortemente convinto della necessità che venga utilizzato, quanto più possibile e soprattutto dalle amministrazioni pubbliche, software libero.
		
		Tra gli strumenti considerati accettabili e con buoni risultati, ma soprattutto con licenza free, deve essere citato \texttt{Win-UFO}\footnote{http://win-ufo.org/about.shtml} (figura \ref{fig:winufo1}). Questo tool, che può essere installato su una semplice chiavetta USB da inserire nel computer oggetto dell'attività \textit{live}, permette di estrapolare e salvare una serie di dati relativi allo stato di funzionamento della macchina sulla quale viene fatto girare.
		
		\begin{figure}
			\centering
			\includegraphics[width=1\linewidth]{pics/winufo1}
			\caption{La schermata principale di Win-UFO}
			\label{fig:winufo1}
		\end{figure}
		
		Rispettando e soprattutto accettando le limitazioni di una analisi ``da vivo'', un software del genere aiuta non poco l'operatore (comunque in possesso di conoscenze informatiche medio-alte) a operare rapidamente prima di repertare il dispositivo.
		
		Win-UFO è distribuito anche assieme alla distribuzioni GNU/Linux CAINE. Si tratta di un prodotto ben documentato (solo in inglese purtroppo), gratuito e degno di approfondimento.

		
		\subsubsection{Conclusioni: live forensics sì o live forensics no\dots}
		
		I dati forensi raccolti in un sistema live possono produrre prove che non sarebbero disponibili in un'immagine statica del disco. Un altro dei vantaggi del ``live'' è la velocità di esecuzione dell'accertamento, per cui la magistratura e i legali in genere tendono a vederla di buon occhio.
		
		Il live forensic opera però con molte limitazioni: gli standard per l'accettazione si stanno evolvendo e i precedenti legali devono ancora essere stabiliti. 
		
		Un investigatore va in contro a rischi come la contaminazione delle prove o il trovarsi di fronte ad una corte che non capisce le implicazioni di determinate prove.
		
		A causa dell'aumento della quantità delle prove digitali disponibili nella vita di ogni giorno, diventerà presto impossibile acquisire tutti i dati di un disco relativi ad un caso.
		
		I progressi in diversi ambiti saranno essenziali per incrementare l'utilità della live forensic, incluso l'utilizzo di strumenti per automatizzare e standardizzare il processo di raccolta e preservazione delle prove.
		
		
%		Fonti
%		Frank Adelstein, ``The mobile forensics platform''
%		Brian Carrier, ``File System Forensic Analysis''
%		Eoghan Casey, ``Digital Evidence and Computer Crime''
%		
%		\begin{itemize}
%			\item Annotare ogni operazione compiuta, possibilmente allegando documentazione fotografica e video;
%			\item Operare sui reperti garantendo l'integrità dei dati, ovvero utilizzando accorgimenti hardware e/o software che blocchino qualsiasi scrittura sul disco;
%			\item Lavorare sempre e soltanto su copie\footnote{I concetti di originale e copia in ambito di informazioni digitali sono dibattuti e controversi. In questo contesto si intende per copia qualsiasi riproduzione dei dati contenuti sul supporto sequestrato.};
%		\end{itemize}
		\newpage
		\listoffigures
\end{document}